"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[28945],{85995:(e,t,n)=>{n.r(t),n.d(t,{StreamPage:()=>X,default:()=>Y});var o=n(814),r=n.n(o),i=(n(71372),n(6886),n(52322)),a=n(46209),s=n(2784),l=n(18671),u=n(4517),d=(n(88233),n(74495)),c=n(97879);var g=n(61872),v=n(49687),f=n(52175);const m=e=>{let{titleInfo:t}=e;return function(e){const t=(0,d.useDispatch)();(0,s.useEffect)((()=>{e&&t(c.Qu.prepend(e))}),[t,e])}(null===t||void 0===t?void 0:t.titleId),null},p=e=>{let{titleInfo:t}=e;const n=(0,f.xz)();return(0,s.useEffect)((()=>{const e=null===t||void 0===t?void 0:t.details.xboxTitleId;e&&n(e.toString())}),[t,n]),null},P=e=>{let{titleInfo:t}=e;return(0,v.nj)(g.y.EnableTitleHubMru)?(0,i.jsx)(p,{titleInfo:t}):(0,i.jsx)(m,{titleInfo:t})};var x=n(90685),h=n(38269),I=n(80631),b=n(5317);var j=n(35626);var k=n(44442),L=(n(36728),n(40866));function S(e){let{context:t,children:n}=e;const o=null!==t&&void 0!==t?t:k.k,{unblockNavigation:r}=(()=>{const e=(0,u.k6)(),t=(0,s.useRef)(),n=(0,d.useSelector)(L.Cb),o=(0,s.useCallback)((()=>{var e;null===(e=t.current)||void 0===e||e.call(t),t.current=void 0}),[]);return(0,s.useEffect)((()=>(t.current=e.block(((t,r)=>(null===n||void 0===n?void 0:n.isProvisioning)?(o(),e.push(t),!1):(null===n||void 0===n||n.requestQuitTitle(t.pathname),!1))),o)),[n,e,o,null===n||void 0===n?void 0:n.xboxTitleId]),{unblockNavigation:o}})();return(0,i.jsx)(o.Provider,{value:{unblockNavigation:r},children:n})}n(31235);var _=n(16216),y=n(4896),D=n(81634),U=n(66747),E=n(79909),R=n(5839),T=n(25774),A=n(9606),w=n(33401),C=n(97906),G=n(5841),M=n(98204),B=n(5653),N=n(24516);const O=()=>{const{productId:e,productName:t}=(0,A.t)(),n=(0,a.useLogger)("PreLaunchChecks"),o=function(){const e=(0,y.T)();if((0,T.r)())return!1;return e}(),r=(0,C.I)(),[s]=(0,U.Z)(e),l=function(e,t){var n;const{location:o}=(0,_.vzw)(),[r]=(0,w.j)(),i=(0,E.M)(r||[]),a=null!==(n=null===o||void 0===o?void 0:o.pathname)&&void 0!==n?n:(0,N.Rz)(),s=B.Product.getLink(e,t);if(a===s||a===decodeURIComponent(s)||a===B.UnfriendlyProduct.getLink(e))return!0;if(i.includes(e))return!0;const l=B.Play.getLink(e,t);if(a===l||a===decodeURIComponent(l)||B.UnfriendlyPlay.getLink(e))return!0;return!1}(e,t),[d,{loading:c}]=(0,G.E)(),[g,{loading:v}]=function(e){var t;const[n,o]=(0,M.I)(e);return[null===(t=null===n||void 0===n?void 0:n.details)||void 0===t?void 0:t.hasEntitlement,o]}(e),[f]=(0,R.B)(e);return d||c?f||(0,D._O)(e)||g||v?o?(n.debug("Redirecting to PDP page: App is not a PWA"),(0,i.jsx)(u.l_,{to:B.Product.getLink(e,t)})):"blocked"===r?(n.debug("Redirecting to PDP page: Browser is blocked"),(0,i.jsx)(u.l_,{to:B.Product.getLink(e,t)})):s&&!s.isAllowed?(n.debug(`Redirecting to PDP page: Family safety settings: ${s.reason}`),(0,i.jsx)(u.l_,{to:B.Product.getLink(e,t)})):l?null:(n.debug("Redirecting to PDP page: User has not seen ESRB rating on PDP page"),(0,i.jsx)(u.l_,{to:B.Product.getLink(e,t)})):(n.debug("Redirecting to PDP page: User does not have entitlement"),(0,i.jsx)(u.l_,{to:B.Product.getLink(e,t)})):(n.debug("Redirecting to PDP page: User is not authed with Game Stream"),(0,i.jsx)(u.l_,{to:B.Product.getLink(e,t)}))};var q=n(53236),H=n(21898),z=n(27168),W=n(55415),K=n(3968),Q=n(87495),F=n(5801),J=n(43947);function V(e){let{productId:t,product:n}=e;const[o]=(0,G.E)(),l=(0,h.l)(o),{streamClient:d}=(0,K.S)(),[c,{loading:g,error:v}]=(0,M.I)(t);(0,j.y)();const f=function(){const e=(0,u.TH)();return(0,s.useMemo)((()=>{if(e.state&&(0,b.Id)(e.state))return{type:"gameInvite"===e.state.kind?I.GameInviteType.Invite:I.GameInviteType.Join,jsonPayload:e.state.payload}}),[e.state])}(),m=function(){const e=(0,u.TH)();return(0,s.useMemo)((()=>{if(e.state&&(0,b._U)(e.state))return e.state.payload}),[e.state])}(),p=(0,s.useMemo)((()=>c?{connectMode:"cloud-connect",titleInfo:r()(r()({},c),{},{product:n}),gameInvite:f,stateShare:m}:void 0),[c,n,f,m]),k=(0,a.useUniqueLogger)("StreamPage");return(0,s.useEffect)((()=>{p||g||k.error("TitleInfo not found when boostrapping GameStream.",v)}),[k,p,g,v]),p||g?(0,i.jsxs)(H.S,{context:"StreamPage",childrenDescription:"GameStreamBootstrapper",children:[(0,i.jsx)(O,{}),p&&l&&o&&(0,i.jsxs)(S,{children:[(0,i.jsx)(x._,{user:o,streamClient:d,config:p}),(0,i.jsx)(P,{titleInfo:p.titleInfo})]})]}):(0,i.jsx)(J.X,{error:null!==v&&void 0!==v?v:new Error("TitleInfo not found when boostrapping GameStream.")})}const X=()=>{const{productId:e}=(0,u.UO)(),[t]=(0,W.M)(e);return(0,i.jsxs)(F.Pl,{location:"StreamPage",children:[(0,i.jsxs)(l.q,{children:[(0,i.jsx)("meta",{name:"viewport",content:Q.Yk}),(0,i.jsx)("meta",{name:"robots",content:"noindex"})]}),(0,i.jsx)(z.V,{title:null===t||void 0===t?void 0:t.title}),(0,i.jsx)(q.I,{children:(0,i.jsx)(V,{productId:e,product:t})})]})},Y=X},38269:(e,t,n)=>{n.d(t,{l:()=>i});n(6886);var o=n(46209),r=n(43204);function i(e){const t=(0,o.useUniqueLogger)("StreamPage/useAreGameStreamRequirementsMet"),[n,{loading:i}]=(0,r.l)();return null==e?(t.debug("Waiting for StreamUser to be defined"),!1):n?!i||(t.debug("Login is currently in progress and must resolve before allowing GameStream to start"),!1):(t.debug("Waiting for a client-side login to occur rather than using the hydrated StreamUser since a server-side authentication may have an incorrect region"),!1)}}}]);
//# sourceMappingURL=stream-page.64674379.chunk.js.map
